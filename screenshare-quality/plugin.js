(()=>{var o=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var g=(n,e)=>{for(var t in e)o(n,t,{get:e[t],enumerable:!0})},M=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of f(e))!m.call(n,a)&&a!==t&&o(n,a,{get:()=>e[a],enumerable:!(i=h(e,a))||i.enumerable});return n};var E=n=>M(o({},"__esModule",{value:!0}),n);var U={};g(U,{onLoad:()=>v,onUnload:()=>C});var{util:{log:Q},flux:{stores:{UserStore:S,MediaEngineStore:x},dispatcher:c}}=shelter,I=[480,720,1080,1440],_=[5,15,30,60],r=720,s=30;function b(n,e){r=u(n,I),s=u(e,_)}function d(){let n=[...x.getMediaEngine().connections],e=S.getCurrentUser().id,t=n.find(i=>i.streamUserId===e);t&&(t.videoStreamParameters[0].maxFrameRate=s,t.videoStreamParameters[0].maxResolution.height=r,t.videoStreamParameters[0].maxResolution.width=Math.round(r*(screen.width/screen.height)),t.videoQualityManager.goliveMaxQuality.bitrateMin=5e5,t.videoQualityManager.goliveMaxQuality.bitrateMax=1e7,t.videoQualityManager.goliveMaxQuality.bitrateTarget=6e5,Q(`Patched current user stream with resolution: ${r} and fps: ${s}`))}function v(){c.subscribe("MEDIA_ENGINE_VIDEO_SOURCE_QUALITY_CHANGED",d)}function C(){c.unsubscribe("MEDIA_ENGINE_VIDEO_SOURCE_QUALITY_CHANGED",d)}function u(n,e){let t=e[0],i=Math.abs(n-t);for(let a=1;a<e.length;a++){let l=Math.abs(n-e[a]);l<i&&(t=e[a],i=l)}return t}window.ScreenshareQuality={};window.ScreenshareQuality.patchScreenshareQuality=b;return E(U);})();
