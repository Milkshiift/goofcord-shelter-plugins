(function(exports){var a=Object.create,b=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,e=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty,g=(T,U)=>()=>(U||T((U={exports:{}}).exports,U),U.exports),h=(T,U,V,W)=>{if(U&&typeof U==="object"||typeof U==="function"){for(var X=d(U),Y=0,Z=X.length,$;Y<Z;Y++)if($=X[Y],!f.call(T,$)&&$!==V)b(T,$,{get:((_)=>U[_]).bind(null,$),enumerable:!(W=c(U,$))||W.enumerable})}return T},i=(T,U,V)=>(V=T!=null?a(e(T)):{},h(U||!T||!T.__esModule?b(V,"default",{value:T,enumerable:!0}):V,T)),j=g((exports,U)=>{U.exports=shelter.solidWeb}),k=i(j(),1),l=i(j(),1),m=i(j(),1),n=i(j(),1),o=i(j(),1),p=i(j(),1),q=i(j(),1),r=i(j(),1),s=i(j(),1),t=i(j(),1);const u=(0,k.template)("<div class=\"encryptContainer2\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path d=\"M144 144v48H304V144c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192V144C80 64.5 144.5 0 224 0s144 64.5 144 144v48h16c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V256c0-35.3 28.7-64 64-64H80z\"></path></svg></div>",6),v=(0,k.template)("<div class=\"encryptContainer2\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path d=\"M352 192H384C419.3 192 448 220.7 448 256V448C448 483.3 419.3 512 384 512H64C28.65 512 0 483.3 0 448V256C0 220.7 28.65 192 64 192H288V144C288 64.47 352.5 0 432 0C511.5 0 576 64.47 576 144V192C576 209.7 561.7 224 544 224C526.3 224 512 209.7 512 192V144C512 99.82 476.2 64 432 64C387.8 64 352 99.82 352 144V192z\"></path></svg></div>",6),w=(0,k.template)("<div id=\"encrypt-icon\"></div>",2),{http:x,flux:y,ui:{injectCss:z,tooltip:A},plugin:{store:B},observeDom:C}=shelter,D=window.goofcord.getConfig("encryptionMark"),E=window.goofcord.getConfig("messageEncryption");async function F(){if(!E)return;I();K();P()}let G,H;function I(){G=x.intercept("post",/\/channels\/\d+\/messages/,(T,U)=>{if(!B.enabled)return U(T);T.body.content=window.goofcord.encryptMessage(T.body.content);return U(T)}),H=x.intercept("patch",/\/channels\/\d+\/messages/,(T,U)=>{if(!B.enabled)return U(T);T.body.content=window.goofcord.encryptMessage(T.body.content);return U(T)})}let J;function K(){J=y.intercept((T)=>{switch(T.type){case "MESSAGE_CREATE":T.message.content=window.goofcord.decryptMessage(T.message.content);break;case "MESSAGE_UPDATE":T.message.content=window.goofcord.decryptMessage(T.message.content);break;case "MESSAGE_START_EDIT":T.content=R(T.content,D);break;case "LOAD_MESSAGES_SUCCESS":for(const U of T.messages)U.content=window.goofcord.decryptMessage(U.content);break}})}const L=(0,t.getNextElement)(u),M=(0,t.getNextElement)(v),N="\n    .encryptContainer {\n      display: flex;\n      align-items: center;\n    }\n    \n    .encryptContainer svg path {\n      fill: var(--interactive-normal) !important;\n    }\n    \n    .encryptContainer2 {\n        padding: 4px;\n        margin-left: 4px;\n        margin-right: 4px;\n    }\n    \n    .encryptContainer.notActive svg path {\n      fill: var(--status-danger) !important;\n    }\n    \n    .encryptContainer svg {\n      width: 21px;\n      height: 21px;\n      cursor: pointer;\n      transition: transform .2s;\n    }\n    \n    .encryptContainer:hover svg {\n      transform: scale(1.15);\n    }\n";let O;async function P(){S(N,"message-encryption-css"),O=C("[class^=\"channelTextArea\"] [class^=\"buttons\"]",(T)=>{if(document.querySelector("#encrypt-icon"))return;const [U,V]=shelter.solid.createSignal(!!B.enabled),W=()=>{B.enabled=!U(),V(!U()),window.goofcord.titlebar.flashTitlebar(B.enabled?"#f9c23c":"#D0D0D0")},X=(()=>{const Y=(0,t.getNextElement)(w);(0,r.use)(A,Y,()=>U()?"Encryption active":"Encryption not active");(0,s.addEventListener)(Y,"contextmenu",window.goofcord.cycleThroughPasswords,!0);Y.$$click=W;(0,p.insert)(Y,()=>U()?L:M);(0,n.effect)((Z)=>{const $=`encryptContainer${U()?"":" notActive"}`,_=T.childElementCount===0&&{display:"none"};$!==Z._v$&&(Y.className=Z._v$=$);Z._v$2=(0,m.style)(Y,_,Z._v$2);return Z},{_v$:void 0,_v$2:void 0});(0,o.runHydrationEvents)();return Y})();T.prepend(X)})}function Q(){if(!E)return;J();G();H();O()}function R(T,U){if(T.startsWith(U))return T.substring(U.length);return T}function S(T,U){const V=document.getElementById(U);if(!V){const W=document.createElement("style");W.id=U;W.textContent=T;document.head.appendChild(W)}else V.textContent=T}(0,l.delegateEvents)(["click","contextmenu"]);exports.onLoad=F;exports.onUnload=Q;return exports})({});